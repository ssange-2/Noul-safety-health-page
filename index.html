<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>안전보건 정밀진단 체크리스트</title>
<style>
  body {
    font-family: Arial, sans-serif;
    padding: 20px;
  }
  h1 {
    text-align: center;
    margin-bottom: 30px;
  }
  table {
    width: 100%;
    border-collapse: collapse;
  }
  th, td {
    border: 1px solid #ccc;
    padding: 8px;
    vertical-align: top;
    text-align: center;
  }
  th {
    background-color: #f4f4f4;
  }
  textarea {
    width: 100%;
    height: 50px;
  }
  .radio-group {
    display: flex;
    justify-content: center;
    gap: 8px;
  }
</style>
</head>

<body>

<h1>안전보건 정밀진단 체크리스트</h1>

<table>
  <thead>
    <tr>
      <th>번호</th>
      <th>점검항목</th>
      <th>점검내용</th>
      <th>점검결과</th>
      <th>특이사항</th>
    </tr>
  </thead>
  <tbody id="checklist-body"></tbody>
</table>

<script>
  const checklistItems = Array.from({ length: 10 }, (_, i) => ({
    id: i + 1,
    title: `점검항목 ${i + 1}`,
    description: `점검내용 ${i + 1}`
  }));
  // ↑ 나중에 100개까지 늘리면 됨

  const tbody = document.getElementById("checklist-body");

  function loadData(id) {
    return JSON.parse(localStorage.getItem(`check_${id}`)) || {};
  }

  function saveData(id, data) {
    localStorage.setItem(`check_${id}`, JSON.stringify(data));
  }

  checklistItems.forEach(item => {
    const saved = loadData(item.id);

    const tr = document.createElement("tr");

    tr.innerHTML = `
      <td>${item.id}</td>
      <td>${item.title}</td>
      <td>${item.description}</td>
      <td>
        <div class="radio-group">
          ${["양호", "미흡", "불량", "해당없음"].map(value => `
            <label>
              <input type="radio" name="result_${item.id}" value="${value}">
              ${value}
            </label>
          `).join("")}
        </div>
      </td>
      <td>
        <textarea placeholder="특이사항 입력"></textarea>
      </td>
    `;

    const radios = tr.querySelectorAll(`input[name="result_${item.id}"]`);
    const textarea = tr.querySelector("textarea");

    if (saved.result) {
      radios.forEach(r => {
        if (r.value === saved.result) r.checked = true;
      });
    }
    if (saved.note) textarea.value = saved.note;

    radios.forEach(radio => {
      radio.addEventListener("change", () => {
        saveData(item.id, {
          result: radio.value,
          note: textarea.value
        });
      });
    });

    textarea.addEventListener("input", () => {
      const checked = [...radios].find(r => r.checked);
      saveData(item.id, {
        result: checked ? checked.value : "",
        note: textarea.value
      });
    });

    tbody.appendChild(tr);
  });
</script>

</body>
</html>
