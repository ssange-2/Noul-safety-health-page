<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>Noul Safety&Health Site Audit</title>
<style>
  body {
    font-family: Arial, sans-serif;
    padding: 20px;
  }
  h1 {
    text-align: center;
    margin-bottom: 30px;
  }
  table {
    width: 100%;
    border-collapse: collapse;
  }
  th, td {
    border: 1px solid #ccc;
    padding: 8px;
    vertical-align: top;
    text-align: center;
  }
  th {
    background-color: #f4f4f4;
  }
  textarea {
    width: 100%;
    height: 50px;
  }
  .radio-group {
    display: flex;
    justify-content: center;
    gap: 8px;
  }
</style>
</head>

<body>

<h1>Noul Safety&Health Site Audit</h1>

<table>
  <thead>
    <tr>
      <th>번호</th>
      <th>점검항목</th>
      <th>점검내용</th>
      <th>점검결과</th>
      <th>특이사항</th>
    </tr>
  </thead>
  <tbody id="checklist-body"></tbody>
</table>

<script>
  const checklistItems = [
    {
      id: 1,
      title: "비상구가 항상 개방 가능하도록 유지되고 있는가?",
      description: "비상구 앞에 적치물, 잠금장치 등이 설치되어 있지 않은지 확인"
    },
    {
      id: 2,
      title: "소화기가 지정된 위치에 비치되어 있는가?",
      description: "소화기 위치표시, 사용 가능 상태, 압력 정상 여부 확인"
    },
    {
      id: 3,
      title: "전기 분전반 주변에 위험요인이 없는가?",
      description: "분전반 주변 적치물, 잠금상태, 감전 위험요소 여부 확인"
    }
  ];

  const tbody = document.getElementById("checklist-body");

  function loadData(id) {
    return JSON.parse(localStorage.getItem(`check_${id}`)) || {};
  }

  function saveData(id, data) {
    localStorage.setItem(`check_${id}`, JSON.stringify(data));
  }

  checklistItems.forEach(item => {
    const saved = loadData(item.id);

    const tr = document.createElement("tr");

    tr.innerHTML = `
      <td>${item.id}</td>
      <td>${item.title}</td>
      <td>${item.description}</td>
      <td>
        <div class="radio-group">
          ${["양호", "미흡", "불량", "해당없음"].map(value => `
            <label>
              <input type="radio" name="result_${item.id}" value="${value}">
              ${value}
            </label>
          `).join("")}
        </div>
      </td>
      <td>
        <textarea placeholder="특이사항 입력"></textarea>
      </td>
    `;

    const radios = tr.querySelectorAll(`input[name="result_${item.id}"]`);
    const textarea = tr.querySelector("textarea");

    if (saved.result) {
      radios.forEach(r => {
        if (r.value === saved.result) r.checked = true;
      });
    }
    if (saved.note) textarea.value = saved.note;

    radios.forEach(radio => {
      radio.addEventListener("change", () => {
        saveData(item.id, {
          result: radio.value,
          note: textarea.value
        });
      });
    });

    textarea.addEventListener("input", () => {
      const checked = [...radios].find(r => r.checked);
      saveData(item.id, {
        result: checked ? checked.value : "",
        note: textarea.value
      });
    });

    tbody.appendChild(tr);
  });
</script>

</body>
</html>
